function q(a,b,d){a=a.width/a.height;return a>b.width/b.height!==d?{width:b.height*a,height:b.height}:{width:b.width,height:b.width/a}}
function r(a,b,d){d=void 0===d?getComputedStyle(a).getPropertyValue("object-fit"):d;a={width:a.naturalWidth,height:a.naturalHeight};switch(d){case "cover":return q(a,b,!1);case "contain":return q(a,b,!0);case "fill":return b;case "none":return a;case "scale-down":return b=q(a,b,!0),{width:Math.min(a.width,b.width),height:Math.min(a.height,b.height)};case "":case null:return b;default:throw Error("object-fit: "+d+" not supported");}};function t(a,b){a=(a.match(new RegExp("-?\\s*\\d+"+b))||["0"])[0].replace(" ","");return Number.parseFloat(a)}function u(a,b,d){var c=a||"50% 50%",e=c.startsWith("calc")?c.indexOf(")")+1:c.indexOf(" ");a=c.slice(0,e)||"";c=c.slice(e)||"";e=t(a,"px");var f=t(c,"px");a=t(a,"%")/100;return{top:t(c,"%")/100*(b.height-d.height)+f,left:a*(b.width-d.width)+e}};function w(a,b,d,c){b=void 0===b?a.getBoundingClientRect():b;d=void 0===d?getComputedStyle(a).getPropertyValue("object-position"):d;c=void 0===c?r(a,b):c;d=u(d,b,c);var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div");a=a.cloneNode(!0);a.className="";a.style.cssText="";h.appendChild(a);g.appendChild(h);f.appendChild(g);e.appendChild(f);Object.assign(f.style,{overflow:"hidden",width:b.width+"px",height:b.height+"px"});Object.assign(h.style,
{transform:"translate("+d.left+"px, "+d.top+"px)"});Object.assign(a.style,{display:"block",width:c.width+"px",height:c.height+"px"});return{B:e,m:f,h:g,u:h,i:a}};function x(a){if("static"!=getComputedStyle(a).position)return a;var b=a.offsetParent||a.parentElement;return b?x(b):a};function y(a){return"cubic-bezier("+a.x1+", "+a.y1+", "+a.x2+", "+a.y2+")"}function z(a,b,d){var c=d*d,e=c*d;return 3*(d-2*c+e)*a+3*(c-e)*b+e};function A(a,b){return{x:a.width/b.width,y:a.height/b.height}};function B(a){var b=a.h,d=a.curve,c=a.styles,e=a.a,f=a.b,g=e+"-crop";e+="-counterScale";var h=A(a.g,a.f),k={x:1,y:1},l=f?h:k;f=f?k:h;Object.assign(a.m.style,c,{willChange:"transform",transformOrigin:"top left",animationName:g,animationTimingFunction:"linear",animationFillMode:"forwards"});Object.assign(b.style,c,{willChange:"transform",transformOrigin:"top left",animationName:e,animationTimingFunction:"linear",animationFillMode:"forwards"});b=a="";for(c=0;20>=c;c++){h=.05*c;var m=z(d.y1,d.y2,h);h=
100*z(d.x1,d.x2,h);k=l.x;k+=m*(f.x-k);var n=l.y;m=n+m*(f.y-n);n=1/k;var p=1/m;a+=h+"% {\n      transform: scale("+k+", "+m+");\n    }";b+=h+"% {\n      transform: scale("+n+", "+p+");\n    }"}return"\n    @keyframes "+g+" {\n      "+a+"\n    }\n\n    @keyframes "+e+" {\n      "+b+"\n    }\n  "};function C(a){var b=a.b,d=a.a+"-scale",c={x:1,y:1},e=A(a.o,a.j),f=b?e:c;b=b?c:e;Object.assign(a.element.style,a.styles,{willChange:"transform",transformOrigin:"top left",animationName:d,animationTimingFunction:y(a.curve),animationFillMode:"forwards"});return"\n    @keyframes "+d+" {\n      from {\n        transform: scale("+f.x+", "+f.y+");\n      }\n\n      to {\n        transform: scale("+b.x+", "+b.y+");\n      }\n    }\n  "};function D(a){var b=a.element,d=a.g,c=a.o,e=a.A,f=a.styles,g=a.b,h=y(a.curve),k=a.a+"-object-position";a=u(a.v,a.f,a.j);c=u(e,d,c);d=g?c:a;g=g?a:c;Object.assign(b.style,f,{willChange:"transform",animationName:k,animationTimingFunction:h,animationFillMode:"forwards"});return"\n    @keyframes "+k+" {\n      from {\n        transform: translate("+d.left+"px, "+d.top+"px);\n      }\n\n      to {\n        transform: translate("+g.left+"px, "+g.top+"px);\n      }\n    }\n  "};function E(a){var b=a.w,d=a.f,c=a.g,e=a.b,f=a.a+"-translation",g=e?c:d;d=e?d:c;c=g.left-d.left;g=g.top-d.top;Object.assign(a.element.style,a.styles,{position:"absolute",top:d.top-b.top+"px",left:d.left-b.left+"px",willChange:"transform",animationName:f,animationTimingFunction:y(a.curve),animationFillMode:"forwards"});return"\n    @keyframes "+f+" {\n      from {\n        transform: translate("+c+"px, "+g+"px);\n      }\n\n      to {\n        transform: translate(0, 0);\n      }\n    }\n  "};var F={x1:.42,y1:0,x2:.58,y2:1},G=0;function H(a){G+=1;return a+"-"+G+"-"}function I(a,b){var d=getComputedStyle(a),c=d.getPropertyValue("object-fit");d=d.getPropertyValue("object-position");return{C:c,l:d,rect:b,i:a,c:r(a,b,c),s:b.width*b.height}};exports.prepareImageAnimation=function(a){var b=void 0===a.transitionContainer?document.body:a.transitionContainer,d=void 0===a.styleContainer?document.head:a.styleContainer,c=a.srcImg,e=a.targetImg,f=void 0===a.srcImgRect?c.getBoundingClientRect():a.srcImgRect,g=void 0===a.targetImgRect?e.getBoundingClientRect():a.targetImgRect,h=void 0===a.curve?F:a.curve,k=a.styles;a=void 0===a.keyframesNamespace?"img-transform":a.keyframesNamespace;c=I(c,f);f=I(e,g);g=(e=f.s>c.s)?c:f;c=e?f:c;a=H(a);var l=w(c.i,
c.rect,c.l,c.c),m=l.B,n=l.m,p=l.h;f=l.u;l=l.i;var J=x(b).getBoundingClientRect();n=B({m:n,h:p,f:c.rect,g:g.rect,curve:h,styles:k,a:a,b:e});p=E({element:m,w:J,f:c.rect,g:g.rect,curve:h,styles:k,a:a,b:e});f=D({element:f,f:c.rect,g:g.rect,j:c.c,o:g.c,v:c.l,A:g.l,curve:h,styles:k,a:a,b:e});h=C({element:l,j:c.c,o:g.c,curve:h,styles:k,a:a,b:e});var v=document.createElement("style");v.textContent=n+f+p+h;return{applyAnimation:function(){d.appendChild(v);b.appendChild(m)},cleanupAnimation:function(){b.removeChild(m);
d.removeChild(v)}}};
